


import sys


if len(sys.argv) < 2:
    print("[-] Usage: %s '<String>'" % sys.argv[0])
    print("[-] Example: %s 'Omri Baso'" % sys.argv[0])
    sys.exit(0)

    
payload = sys.argv[1]

bit_32 = 4
bit_64 = 8

arch = bit_32


for i in range(0, len(payload), arch):
    curr = (payload[i:i+arch])[::-1]
    curr = [ i.encode().hex() for i in curr]
    curr = "0x"+"".join(curr)
    print("push",curr)

print("""xor ecx, ecx
push ecx
push esp
pop edi ; this line can be removed it stores the pointer inside edi, not needed if we want to push the pointer directly now""")



    


